{
  "id": "US-074",
  "title": "Integrate CodeRabbit pre-commit check into ALL Ralph stories",
  "description": "Add CodeRabbit CLI as a free quality gate before committing ANY story (US, BUG, AUDIT, V, TEST). After implementation but before commit, run 'cr review' to catch issues. If issues found, fix them before marking complete. This is free for open source repos - no reason not to use it.",
  "type": "feature",
  "priority": "high",
  "storyPoints": 3,
  "status": "pending",
  "acceptanceCriteria": [
    {"text": "Add _ralph_coderabbit_review() function to ralph.zsh", "checked": true},
    {"text": "Function runs after story implementation, before commit", "checked": true},
    {"text": "Run: cr review --prompt-only (for AI agent consumption)", "checked": true},
    {"text": "Parse output for issues (CRITICAL/HIGH/MEDIUM)", "checked": true},
    {"text": "If issues found: include them in prompt, ask model to fix", "checked": true},
    {"text": "After fixes: re-run CodeRabbit to verify", "checked": true},
    {"text": "Only commit when CodeRabbit passes (or --skip-coderabbit flag)", "checked": true},
    {"text": "Only runs for allowed repos (claude-golem, songscript)", "checked": true},
    {"text": "Gracefully handle missing cr CLI (warn and continue)", "checked": true},
    {"text": "Add RALPH_CODERABBIT_ENABLED config option (default: true)", "checked": true},
    {"text": "Log CodeRabbit results to progress.txt", "checked": true},
    {"text": "Document in README: how CodeRabbit integration works", "checked": true},
    {"text": "Document: how to add more repos to allowed list", "checked": true},
    {"text": "Add to ralph-setup wizard: CodeRabbit configuration step", "checked": true},
    {"text": "  - Prompt: 'Enable CodeRabbit pre-commit checks? (free for open source)'", "checked": true},
    {"text": "  - Prompt: 'Which repos? (comma-separated or * for all)'", "checked": true},
    {"text": "  - Save to config.json: coderabbit.enabled, coderabbit.repos[]", "checked": true},
    {"text": "Test: Make intentional bug, verify CodeRabbit catches it", "checked": false}
  ],
  "dependencies": [],
  "passes": false
}
